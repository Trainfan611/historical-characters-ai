# üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫ Telegram –±–æ—Ç–∞

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ Railway (–∏–ª–∏ –≤ `.env`) —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:

```env
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
TELEGRAM_ADMIN_ID=–≤–∞—à_telegram_id
NEXTAUTH_URL=https://–≤–∞—à-–¥–æ–º–µ–Ω.railway.app
```

**–í–∞–∂–Ω–æ:**
- `TELEGRAM_BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather
- `TELEGRAM_BOT_TOKEN_BASE` ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `TELEGRAM_BOT_TOKEN`
- `TELEGRAM_ADMIN_ID` ‚Äî –≤–∞—à Telegram ID (—á–∏—Å–ª–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä: `123456789`)

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ API

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://–≤–∞—à-–¥–æ–º–µ–Ω.railway.app/api/telegram/test
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```json
{
  "hasToken": true,
  "tokenLength": 46,
  "tokenSource": "TELEGRAM_BOT_TOKEN",
  "hasAdminId": true,
  "adminId": "123456789",
  "webhookUrl": "https://–≤–∞—à-–¥–æ–º–µ–Ω.railway.app/api/telegram/webhook",
  "status": "ok"
}
```

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫ ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Railway.

---

## üîó –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Webhook

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ webhook —á–µ—Ä–µ–∑ curl:

```bash
curl -X POST "https://api.telegram.org/bot–í–ê–®_–¢–û–ö–ï–ù/setWebhook?url=https://–≤–∞—à-–¥–æ–º–µ–Ω.railway.app/api/telegram/webhook"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook:

```bash
curl "https://api.telegram.org/bot–í–ê–®_–¢–û–ö–ï–ù/getWebhookInfo"
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```json
{
  "ok": true,
  "result": {
    "url": "https://–≤–∞—à-–¥–æ–º–µ–Ω.railway.app/api/telegram/webhook",
    "has_custom_certificate": false,
    "pending_update_count": 0
  }
}
```

---

## üÜî –ö–∞–∫ —É–∑–Ω–∞—Ç—å —Å–≤–æ–π Telegram ID

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ –±–æ—Ç–∞ @userinfobot
1. –û—Ç–∫—Ä–æ–π—Ç–µ [@userinfobot](https://t.me/userinfobot)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
3. –ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç –≤–∞—à ID

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ –±–æ—Ç–∞ @getidsbot
1. –û—Ç–∫—Ä–æ–π—Ç–µ [@getidsbot](https://t.me/getidsbot)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç –≤–∞—à ID

### –°–ø–æ—Å–æ–± 3: –ß–µ—Ä–µ–∑ –≤–µ–±-–≤–µ—Ä—Å–∏—é Telegram
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://web.telegram.org
2. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Console
4. –í–≤–µ–¥–∏—Ç–µ: `window.Telegram.WebApp.initDataUnsafe.user.id`
5. –ù–∞–∂–º–∏—Ç–µ Enter ‚Äî —É–≤–∏–¥–∏—Ç–µ –≤–∞—à ID

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞

### 1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/start` –±–æ—Ç—É

–ï—Å–ª–∏ –≤—ã –∞–¥–º–∏–Ω (–≤–∞—à `TELEGRAM_ADMIN_ID` —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å ID –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è), –±–æ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π:

```
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Historical Characters

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 123
–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π: 456
–ì–µ–Ω–µ—Ä–∞—Ü–∏–π –≤—Å–µ–≥–æ: 789
–ì–µ–Ω–µ—Ä–∞—Ü–∏–π —Å–µ–≥–æ–¥–Ω—è: 12
```

### 2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/admin` –±–æ—Ç—É

–ï—Å–ª–∏ –≤—ã –∞–¥–º–∏–Ω, –±–æ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å.

---

## üêõ –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã

**–ü—Ä–∏—á–∏–Ω—ã:**
- Webhook –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL webhook
- –ë–æ—Ç –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook: `curl "https://api.telegram.org/bot–í–ê–®_–¢–û–ö–ï–ù/getWebhookInfo"`
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ webhook –∑–∞–Ω–æ–≤–æ (—Å–º. —Ä–∞–∑–¥–µ–ª "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Webhook")
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Railway –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–µ"

**–ü—Ä–∏—á–∏–Ω—ã:**
- `TELEGRAM_ADMIN_ID` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- `TELEGRAM_ADMIN_ID` –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –≤–∞—à–∏–º Telegram ID

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–∑–Ω–∞–π—Ç–µ –≤–∞—à Telegram ID (—Å–º. —Ä–∞–∑–¥–µ–ª "–ö–∞–∫ —É–∑–Ω–∞—Ç—å —Å–≤–æ–π Telegram ID")
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `TELEGRAM_ADMIN_ID` –≤ Railway
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Railway

### –ü—Ä–æ–±–ª–µ–º–∞ 3: "TELEGRAM_BOT_TOKEN_BASE and TELEGRAM_BOT_TOKEN are not set"

**–ü—Ä–∏—á–∏–Ω—ã:**
- –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `TELEGRAM_BOT_TOKEN` –∏–ª–∏ `TELEGRAM_BOT_TOKEN_BASE`

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `TELEGRAM_BOT_TOKEN` –≤ Railway
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç, –Ω–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω—ã:**
- –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–±–ª–µ–º—ã —Å Prisma

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Railway –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞

---

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

### –í Railway:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç –≤ Railway
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Deployments"
3. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π
4. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏

### –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö:

**–£—Å–ø–µ—à–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã:**
```
[Telegram Webhook] Received update: { updateId: 123, hasMessage: true, ... }
[Telegram Bot] Received command: { chatId: "123456789", text: "/start", ... }
[Telegram Bot] Sending admin stats to: 123456789
[Telegram Bot] Sending message { chatId: "123456789", ... }
```

**–û—à–∏–±–∫–∏:**
```
[Telegram Bot] Error sending message: ...
[Telegram Bot] Error sending admin stats: ...
[Telegram Webhook] Error processing webhook: ...
```

---

## üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞

–ï—Å–ª–∏ –±–æ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

1. **–í Railway:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "Settings"
   - –ù–∞–∂–º–∏—Ç–µ "Restart"

2. **–ò–ª–∏ —á–µ—Ä–µ–∑ –Ω–æ–≤—ã–π –¥–µ–ø–ª–æ–π:**
   - –°–¥–µ–ª–∞–π—Ç–µ –∫–æ–º–º–∏—Ç –≤ GitHub
   - Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é

---

## üìû –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–º–æ—â—å

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–µ–Ω–∞:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Railway
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook —á–µ—Ä–µ–∑ `getWebhookInfo`
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω

---

**–£–¥–∞—á–∏! üöÄ**
